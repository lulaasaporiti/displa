<div class="content">
    <app-loading-spinner></app-loading-spinner>

    <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="15px">
        <h4 fxLayout="column" class="titulo" fxFlex>Usuarios</h4>
        <mat-form-field fxLayout="column" fxFlex="40" class="buscador">
            <input matInput (keyup)="applyFilter($event.target.value)" #search placeholder="Buscar">
        </mat-form-field>
    </div>
    <mat-divider fxFlexOffset="2"></mat-divider>

    <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="6px" class="menu-agregar">
        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="6px" class="menu-agregar">
          <button mat-mini-fab class="buttonFixed" color="primary" (click)="agregarUsuario()">
            <mat-icon svgIcon="add"></mat-icon>
          </button>
          <p>Agregar</p>
        </div>
        
        <a mat-button *ngIf="traerVigentes" class="footer-list" routerLink="." (click)="cambiarListado()">Mostrar todos</a>
        <a mat-button *ngIf="!traerVigentes" class="footer-list" routerLink="." (click)="cambiarListado()">Mostrar vigentes</a>
      </div>
    <mat-divider></mat-divider>

    <table mat-table fxFill [dataSource]="dataSource" matSort fxFlexOffset="3" class="tabla">

        <ng-container matColumnDef="Activo">
            <th mat-header-cell *matHeaderCellDef mat-sort-header fxFlex="8">ACTIVO</th>
            <td mat-cell *matCellDef="let row" fxFlex="8" fxLayoutAlign="start center">
                <mat-slide-toggle color="accent" [checked]="row.Activo" (click)="activarUsuario(row)">
                </mat-slide-toggle>
            </td>
        </ng-container>

        <ng-container matColumnDef="Username">
            <th mat-header-cell *matHeaderCellDef mat-sort-header fxFlex="22">USUARIO</th>
            <td mat-cell *matCellDef="let row" fxFlex="22" fxLayoutAlign="start center">
                <a routerLink="." *ngIf="row.Id == idUser" class="link" (click)="openDialogEditUserPass();">
                    <b>{{row.UserName}}</b>
                </a>
                <div *ngIf="row.Id != idUser">
                    {{row.UserName}}
                </div>
            </td>
        </ng-container>

        <ng-container matColumnDef="Nombre">
            <th mat-header-cell *matHeaderCellDef mat-sort-header fxFlex="20">NOMBRE</th>
            <td mat-cell *matCellDef="let row" fxFlex="20" fxLayoutAlign="start center"> {{row.Nombre}} </td>
        </ng-container>

        <ng-container matColumnDef="Apellido">
            <th mat-header-cell *matHeaderCellDef mat-sort-header fxFlex="20">APELLIDO</th>
            <td mat-cell *matCellDef="let row" fxFlex="20" fxLayoutAlign="start center"> {{row.Apellido}} </td>
        </ng-container>

        <ng-container matColumnDef="Roles">
            <th mat-header-cell fxFlex="20" *matHeaderCellDef>ROLES</th>
            <td mat-cell fxFlex="20" *matCellDef="let row">
                <mat-chip-list>
                    <mat-chip>{{row.Roles.Name}}</mat-chip>
                </mat-chip-list>
            </td>
        </ng-container>

        <ng-container matColumnDef="Opciones">
            <th mat-header-cell *matHeaderCellDef fxFlex="10"></th>
            <td mat-cell *matCellDef="let row" fxFlex="10" fxLayoutAlign="end">
                <button mat-icon-button matTooltip="Modificar" [matTooltipPosition]="'above'" aria-label="Modificar"
                    (click)="modificarUsuario(row)">
                    <mat-icon svgIcon="edit_outline" class="tabla_icono"></mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" fxFill></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" fxFill></tr>
    </table>
    <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 20, 50]"></mat-paginator>
</div>